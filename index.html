<!doctype html>
<html lang="en">
    <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">

    <link rel="stylesheet" href="./style.css">

    <title>拉 霸 機</title>
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div box-id="1" class="col-1"></div>
                <div box-id="2" class="col-1"></div>
                <div box-id="3" class="col-1"></div>
                <div box-id="4" class="col-1"></div>
                <div box-id="5" class="col-1"></div>
                <div box-id="6" class="col-1"></div>
                <div box-id="7" class="col-1"></div>
                <div box-id="8" class="col-1"></div>
                <div box-id="9" class="col-1"></div>
                <div box-id="10" class="col-1"></div>
                <div box-id="11" class="col-1"></div>
                <div box-id="12" class="col-1"></div>
            </div>
            <div class="row">
                <div box-id="32" class="col-1"></div>
                <div class="col-10 m-auto">
                    <p id="msg" class="m-0"></p>
                </div>
                <div box-id="13" class="col-1"></div>
            </div>
            <div class="row">
                <div box-id="31"class="col-1"></div>
                <div class="col-10 m-auto">
                    
                </div>
                <div box-id="14"class="col-1"></div>
            </div>
            <div class="row">
                <div box-id="30"class="col-1"></div>
                <div class="col-10 m-auto">
                    
                </div>
                <div box-id="15"class="col-1"></div>
            </div>
            <div class="row">
                <div box-id="29"class="col-1"></div>
                <div class="col-10 m-auto">
                    
                </div>
                <div box-id="16"class="col-1"></div>
            </div>
            <div class="row">
                <div box-id="28" class="col-1"></div>
                <div box-id="27" class="col-1"></div>
                <div box-id="26" class="col-1"></div>
                <div box-id="25" class="col-1"></div>
                <div box-id="24" class="col-1"></div>
                <div box-id="23" class="col-1"></div>
                <div box-id="22" class="col-1"></div>
                <div box-id="21" class="col-1"></div>
                <div box-id="20" class="col-1"></div>
                <div box-id="18" class="col-1"></div>
                <div box-id="19" class="col-1"></div>
                <div box-id="17" class="col-1"></div>
            </div>
            <div class="row">
                <button class="btn btn-primary">Start</button>
            </div>
        </div>

        <!-- <i class="fab fa-facebook-square"></i>
        <i class="fab fa-instagram-square"></i>
        <i class="fab fa-line"></i> -->
        <script>
            let brickData = [
                {
                    id: '1',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '2',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '3',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '4',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '5',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '6',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '7',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '8',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '9',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '10',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '11',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '12',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '13',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '14',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '15',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '16',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '17',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '18',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '19',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '20',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '21',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '22',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '23',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '24',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '25',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '26',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '27',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '28',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '29',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '30',
                    color: 'green',
                    icon: 'fab fa-line',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                },
                {
                    id: '31',
                    color: 'blue',
                    icon: 'fab fa-facebook-square',
                    target: function(){
                            return this.icon.split('-')[1];
                    }
                },
                {
                    id: '32',
                    color: 'pink',
                    icon: 'fab fa-instagram-square',
                    target: function(){
                        return this.icon.split('-')[1];
                    }
                }
            ];
        
            let steps = 0;//剩餘要走的步數
            let allSteps = 0; //全部的步數
            let currentIndex = 0; //目前在哪格
            let speed; //速率(越大越慢)

            let bricks =document.querySelectorAll('[box-id]');
            bricks = Array.from(bricks).sort((a,b) => {
                return a.getAttributeNode('box-id').value - b.getAttributeNode('box-id').value;
            })

            bricks.forEach((x , index) => {
                let id = index + 1;
                let data = brickData.find(x => x.id == id);
                let icon = document.createElement('i');
                icon.setAttribute('class' , data.icon);
                icon.style.color = data.color;
                x.appendChild(icon);
            });

            //button start的事情

            document.querySelector('button'),addEventListener('click' , function(){
                speed =50;

                let random = Math.floor(Math.random() * brickData.length) + 1 ;
                steps = random + (3 * brickData.length);
                allSteps = steps;
                turnAtround();
            });

            function turnAtround(){
                bricks[currentIndex].classList.remove('active');
                currentIndex++;

                if(currentIndex >= bricks.length) currentIndex = 0;
                
                bricks[currentIndex].classList.add('active');
                steps--;

                // //一般速度
                // if(steps > 0){
                //     setTimeout(turnAtround , speed);
                // }
                // else{
                //     //跑完了
                //     let msgBox = document.getElementById('msg');
                //     let val = brickData[currentIndex].target();
                //     msgBox.innerText = `接下來 -> ${val}`;
                // }

                //變速速度
                if(steps > 0){
                    setTimeout(turnAtround , speed);
                    if(steps < Math.floor((allSteps / 3))) speed +=7;
                } else{
                    //跑完了
                    let msgBox = document.getElementById('msg');
                    let val = brickData[currentIndex].target();
                    msgBox.innerText = `接下來 -> ${val}`;
                }
            }
            
        </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>

    </body>
</html>